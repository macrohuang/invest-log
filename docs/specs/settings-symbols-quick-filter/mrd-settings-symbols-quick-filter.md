# Settings-Symbols 快速筛选 MRD

> 文件名：`docs/specs/settings-symbols-quick-filter/mrd-settings-symbols-quick-filter.md`

## 1. 背景与目标
- 背景问题：`Settings > Symbols` 列表在符号较多时难以快速定位目标，修改名称/资产类型/自动更新开关需要频繁滚动查找。
- 业务目标：在符号管理页面提供“快速筛选”，缩短定位目标符号并执行编辑操作的时间。
- 成功指标（可量化）：
  - 用户在输入关键字后可在前端即时看到过滤结果（无额外 API 请求）。
  - 可见结果数量反馈清晰（如 `x / y`）。
  - 无匹配时有明确提示。

## 2. 用户与场景
- 目标用户：维护持仓元数据的个人投资者。
- 核心使用场景：用户在 Symbols 管理页输入股票代码或名称片段，快速定位并保存单个符号配置。
- 非目标用户：需要复杂组合查询（多字段高级条件）、批量编辑流程的用户。

## 3. 范围定义
- In Scope：
  - 在 `Settings > Symbols` 增加关键字快速筛选输入框。
  - 支持按 `Symbol`、`Name`、`Asset Type` 字段进行大小写不敏感匹配。
  - 输入时实时筛选并对匹配内容进行高亮反馈。
  - 提供“一键清空筛选”。
  - 展示筛选计数与“无匹配结果”提示。
- Out of Scope：
  - 后端 API 增改。
  - 分页/排序能力改造。
  - 筛选条件持久化（刷新后恢复）。

## 4. 需求明细
- 功能需求 FR-1：Symbols 卡片顶部展示快速筛选控件（输入框 + 清空按钮）。
- 功能需求 FR-2：用户输入关键字时，表格行实时过滤，匹配字段为 `symbol`、`name`、`asset_type`。
- 功能需求 FR-3：显示当前可见行数与总行数；未输入筛选词时显示总数。
- 功能需求 FR-4：当无匹配结果时显示占位行提示，不影响已有数据。
- 功能需求 FR-5：筛选命中时提供高亮反馈（匹配文本高亮，匹配字段视觉强调）。
- 非功能需求 NFR-1（性能/安全/可靠性等）：筛选在本地内存中完成，不触发网络请求；输入响应应保持流畅。

## 5. 约束与依赖
- 技术约束：当前前端为原生 JS 单文件逻辑（`static/app.js`），样式在 `static/style.css`。
- 数据约束：符号列表数据来源 `GET /api/symbols`，本需求仅消费现有字段。
- 外部依赖：无新增第三方依赖。

## 6. 边界与异常
- 边界条件：
  - 符号名为空（仅按 symbol 匹配）。
  - 输入为空字符串（显示全部）。
  - 输入大小写混合与包含空格（需 trim + case-insensitive）。
- 异常处理：前端筛选不依赖网络，异常风险低；若 DOM 缺失则安全降级为不启用筛选。
- 失败回退：移除筛选输入后不影响原始 Symbols 编辑与保存流程。

## 7. 验收标准
- AC-1（可验证）：在 Symbols 页输入 `AAPL`、名称片段、或资产类型片段（如 `stock`）时，列表仅显示匹配行。
- AC-2（可验证）：点击“Clear”后恢复全部行，并更新计数显示。
- AC-3（可验证）：输入不存在关键字时显示“无匹配”提示行。
- AC-4（可验证）：输入关键字后，命中内容有高亮反馈。
- AC-4（可验证）：过滤后点击某行 `Save` 仍可成功更新符号。

## 8. 待确认问题
- Q1：是否需要下一步新增 `auto_update` 维度筛选？
- Q2：是否需要记住上次筛选词（localStorage 持久化）？（当前按你要求不做）

## 9. 假设与决策记录
- 假设：本次“快速筛选”优先满足高频“按代码/名称定位”场景。
- 决策：采用纯前端即时筛选实现，匹配 `Symbol + Name + Asset Type`，并提供实时高亮反馈；文案保持英文。
